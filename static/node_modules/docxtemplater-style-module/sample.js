const fs = require("fs");
const DocxTemplater = require("docxtemplater");

const StyleModule = require("./es6");
const styleModule = new StyleModule();
const PizZip = require("pizzip");

const content = fs.readFileSync("demo_template.docx");

const zip = new PizZip(content);
const docx = new DocxTemplater().loadZip(zip);
docx.attachModule(styleModule);
docx.setData({
	label: "Hello",
	style: {
		cellBackground: "#00ff00",
		textColor: "#ffffff",
	},
	style2: {
		cellBackground: "#ff0000",
		textColor: "#0000ff",
	},
});

docx.render();
const buffer = docx
	.getZip()
	.generate({ compression: "DEFLATE", type: "nodebuffer" });
fs.writeFileSync("demo_generated.docx", buffer);
